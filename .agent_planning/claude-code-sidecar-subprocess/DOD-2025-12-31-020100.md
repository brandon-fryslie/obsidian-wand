# Definition of Done: Claude Code via Sidecar Subprocess

## P0-1: Subprocess Spawning Infrastructure

- [ ] `child_process.spawn()` successfully launches Claude Code CLI
- [ ] Plugin tracks subprocess PID and state
- [ ] `cleanup()` terminates subprocess gracefully
- [ ] Spawn failure shows user-friendly error message
- [ ] Works on macOS (primary), Windows and Linux (secondary)

## P1-1: IPC Communication Layer

- [ ] Plugin can send JSON message to subprocess stdin
- [ ] Plugin receives JSON response from subprocess stdout
- [ ] Messages are correctly delimited and parsed
- [ ] 30-second timeout on unresponsive subprocess
- [ ] Large responses (>1MB) handled correctly

## P1-2: Expose Obsidian Tools to Subprocess

- [ ] `vault_readFile` callable from subprocess, returns file content
- [ ] `vault_writeFile` callable from subprocess, writes file
- [ ] `vault_listFiles` callable from subprocess, returns file list
- [ ] `vault_searchText` callable from subprocess, returns matches
- [ ] `workspace_openFile` callable from subprocess, opens file in Obsidian
- [ ] Tool errors returned as structured error responses

## Integration Validation

- [ ] End-to-end: Send prompt → Claude Code processes → calls Obsidian tool → returns result
- [ ] User can ask "list files in my vault" and get correct response
- [ ] User can ask "create a note called Test" and note is created
