# Status Report - E2E Testing for Obsidian Tool-Calling Agent
Timestamp: 2025-12-16-235920
Scope: topic/e2e-testing
Confidence: FRESH

## Executive Summary
**Overall**: 5% complete | **Critical issues**: 5 | **Tests reliable**: N/A (no tests exist)
**Status**: E2E testing infrastructure does NOT exist. Playwright is installed but not configured. No test files, no config, no automation scripts.

## Project Context

### What This Plugin Does
- Natural language automation for Obsidian (Electron app)
- LLM generates structured plans → user confirms → deterministic execution
- Must interact with real Obsidian UI and vault to verify end-to-end flows
- Desktop-only plugin (requires internal APIs not available on mobile)

### Why E2E Testing Matters
1. **UI flows cannot be unit tested** - Chat interface, plan preview, approval workflow
2. **Obsidian API integration** - Real vault operations (create files, modify notes, search)
3. **Plugin lifecycle** - Loading, enabling, settings persistence
4. **Real-world scenarios** - Complete user journeys from input to execution
5. **Regression prevention** - Catch UI breaks and API changes early

---

## What Exists: Current Test Infrastructure

### Unit Tests (Jest) ✅
**Status**: Working, comprehensive
**Location**: `/Users/bmf/code/obsidian-toolagent/tests/`
**Coverage**:
- ✅ `Executor.test.ts` (702 lines) - Sequential execution, dependencies, foreach, retries
- ✅ `PlanValidator.test.ts` - Schema validation, tool allowlist, path sandboxing
- ✅ `ToolsLayer.test.ts` - Tool dispatch, argument validation
- ✅ `ActionPlanSchema.test.ts` - Zod schema validation
- ✅ `pathValidation.test.ts` - Path security checks

**Test Command**: `pnpm run test` (working, all tests pass)
**Configuration**: `jest.config.js` - ts-jest, mocked Obsidian API
**Mock Layer**: `tests/__mocks__/obsidian.ts` (329 lines) - Comprehensive Obsidian API mocks

**Verdict**: Unit tests are SOLID. They cover business logic, validation, and execution engine. But they CANNOT test:
- Real Obsidian UI rendering
- Plugin loading in Obsidian
- User interaction flows
- Vault operations in real filesystem
- Settings UI and persistence

### Playwright Dependency ⚠️
**Status**: Installed but NOT configured
**Version**: 1.57.0 (latest)
**Installation**: ✅ Package in devDependencies
**Browsers**: ✅ Chromium installed at `/Users/bmf/Library/Caches/ms-playwright/`
**Config**: ❌ No `playwright.config.ts` exists
**Tests**: ❌ No E2E test files exist
**Scripts**: ❌ `package.json` has `"test:e2e": "playwright test"` but it does nothing (no tests)

### Test Vault Setup ✅
**Status**: Script exists, functional
**Location**: `/Users/bmf/code/obsidian-toolagent/bin/seed-vault.sh`
**Purpose**: Seeds test vault with realistic notes (Daily, Projects, Meetings, Reference)
**Usage**: Called by `just setup` recipe
**Verdict**: This is GOOD infrastructure for E2E tests. Creates realistic vault state.

### Obsidian Installation ✅
**Status**: Installed on macOS
**Path**: `/Applications/Obsidian.app/Contents/MacOS/Obsidian`
**Executable**: Available
**Test Vault**: `~/obsidian-test-vault` (configured in justfile)
**Verdict**: Can launch Obsidian for testing.

---

## What's Missing: E2E Infrastructure

### 1. Playwright Configuration ❌
**File**: `playwright.config.ts` (DOES NOT EXIST)

**What's needed**:
```typescript
// playwright.config.ts
import { defineConfig } from '@playwright/test';

export default defineConfig({
  testDir: './e2e',
  timeout: 60000, // Obsidian can be slow to launch
  workers: 1, // Serial execution (Obsidian single instance)
  use: {
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
  },
  projects: [
    {
      name: 'obsidian-e2e',
      use: {
        // Will need custom launch script for Obsidian
      },
    },
  ],
});
```

**Complexity**: MEDIUM - Standard Playwright config but need custom Electron launch strategy

### 2. Obsidian Automation Strategy ❌
**Challenge**: Obsidian is closed-source, packaged Electron app

**Options researched**:

#### Option A: Playwright Electron Mode
- **Approach**: `_electron.launch({ executablePath: '/path/to/Obsidian' })`
- **Pros**: Native Playwright support for Electron apps
- **Cons**:
  - Needs `--remote-debugging-port` flag passed to Obsidian
  - May require wrapping Obsidian launch script
  - Electron support is "experimental" per Playwright docs
- **Risk**: MEDIUM - May hit compatibility issues with packaged app
- **Sources**:
  - [Playwright Electron API](https://playwright.dev/docs/api/class-electron)
  - [Automated Testing | Electron](https://www.electronjs.org/docs/latest/tutorial/automated-testing)

#### Option B: Chromium DevTools Protocol (CDP)
- **Approach**: Launch Obsidian with `--remote-debugging-port=9222`, connect via `playwright.chromium.connectOverCDP()`
- **Pros**: More direct control, works with packaged apps
- **Cons**:
  - Needs to launch Obsidian separately
  - Must manage process lifecycle
  - More boilerplate
- **Risk**: LOW - Well-documented approach

#### Option C: Obsidian URI + Web Mode
- **Approach**: Use `obsidian://` URIs to trigger actions, verify via file system
- **Pros**: No deep Electron automation needed
- **Cons**:
  - Cannot test UI directly
  - Limited to URI-exposed actions
  - Not truly E2E
- **Risk**: LOW but LIMITED value

**Recommendation**: Start with Option B (CDP) for maximum compatibility with packaged Obsidian.

### 3. E2E Test Files ❌
**Directory**: `e2e/` (DOES NOT EXIST)

**Critical test scenarios needed**:

#### A. Plugin Lifecycle (`e2e/plugin-lifecycle.spec.ts`)
```typescript
test('plugin loads and appears in sidebar', async ({ page }) => {
  // Launch Obsidian with test vault
  // Verify plugin appears in left sidebar
  // Click plugin icon
  // Verify chat view opens
});

test('plugin can be enabled/disabled in settings', async ({ page }) => {
  // Open Settings
  // Navigate to Community Plugins
  // Verify plugin appears
  // Toggle enable/disable
  // Verify state persists
});
```

**Status**: MISSING
**Complexity**: HIGH - Requires Obsidian launch automation
**Dependencies**: CDP connection, vault with plugin installed

#### B. Chat Interface (`e2e/chat-interface.spec.ts`)
```typescript
test('user can type message and submit', async ({ page }) => {
  // Open chat view
  // Type in input field
  // Press Enter or click Send
  // Verify message appears in history
});

test('streaming LLM response renders progressively', async ({ page }) => {
  // Mock LLM streaming response
  // Submit request
  // Verify chunks appear progressively
  // Verify thinking blocks toggle
});
```

**Status**: MISSING
**Complexity**: MEDIUM - Standard UI testing
**Dependencies**: Plugin loaded, chat view visible

#### C. Plan Preview & Approval (`e2e/plan-approval.spec.ts`)
```typescript
test('user can review plan before execution', async ({ page }) => {
  // Submit request: "Create note Daily/2024-01-20.md"
  // Wait for plan preview
  // Verify preview shows file creation
  // Verify risk level displayed
  // Verify assumptions listed
});

test('user can approve plan and see execution', async ({ page }) => {
  // Submit request
  // Approve plan
  // Verify progress bar appears
  // Verify step-by-step progress
  // Verify completion message
});

test('user can cancel plan before execution', async ({ page }) => {
  // Submit request
  // Wait for preview
  // Click Cancel
  // Verify no execution occurs
  // Verify vault unchanged
});
```

**Status**: MISSING
**Complexity**: MEDIUM-HIGH - Requires LLM mocking or real API
**Dependencies**: Chat interface working, LLM response handling

#### D. Execution Verification (`e2e/execution-verification.spec.ts`)
```typescript
test('file creation plan creates actual file', async ({ page }) => {
  // Submit: "Create note test.md with content Hello"
  // Approve plan
  // Wait for completion
  // Verify file exists in vault: ~/obsidian-test-vault/test.md
  // Verify file content matches
});

test('failed execution shows error to user', async ({ page }) => {
  // Submit plan that will fail (e.g., write to invalid path)
  // Approve plan
  // Verify error message displayed
  // Verify user-friendly error text
  // Verify vault unchanged
});

test('multi-step plan executes in correct order', async ({ page }) => {
  // Submit plan with dependencies
  // Verify execution order via progress updates
  // Verify all steps complete
  // Verify results correct
});
```

**Status**: MISSING
**Complexity**: MEDIUM - Requires vault file verification
**Dependencies**: Execution engine working, vault access

#### E. Settings Persistence (`e2e/settings.spec.ts`)
```typescript
test('API key saved and persists across reload', async ({ page }) => {
  // Open settings
  // Enter API key
  // Save settings
  // Restart plugin (or reload Obsidian)
  // Verify API key still present
});

test('safety settings affect plan approval', async ({ page }) => {
  // Enable "confirmWrites"
  // Submit write plan
  // Verify confirmation required
  // Disable "confirmWrites"
  // Verify no confirmation for read-only plan
});
```

**Status**: MISSING
**Complexity**: HIGH - Requires Obsidian reload, persistence checks
**Dependencies**: Settings UI working

### 4. Test Helpers & Utilities ❌
**File**: `e2e/helpers/` (DOES NOT EXIST)

**Needed utilities**:

#### `obsidian-launcher.ts`
```typescript
export async function launchObsidian(
  vaultPath: string,
  debugPort: number = 9222
): Promise<ChildProcess> {
  // Launch Obsidian with remote debugging
  // Wait for CDP connection
  // Return process handle
}

export async function closeObsidian(process: ChildProcess): Promise<void> {
  // Gracefully close Obsidian
  // Clean up temp files
}
```

**Status**: MISSING
**Complexity**: MEDIUM

#### `vault-helpers.ts`
```typescript
export async function cleanVault(vaultPath: string): Promise<void> {
  // Remove all notes (except .obsidian)
  // Reset to known state
}

export async function verifyFileExists(
  vaultPath: string,
  filePath: string
): Promise<boolean> {
  // Check file exists in vault
}

export async function readVaultFile(
  vaultPath: string,
  filePath: string
): Promise<string> {
  // Read file content from vault
}
```

**Status**: MISSING
**Complexity**: LOW

#### `plugin-helpers.ts`
```typescript
export async function installPlugin(
  vaultPath: string,
  pluginPath: string
): Promise<void> {
  // Copy plugin files to .obsidian/plugins/
  // Update community-plugins.json
}

export async function enablePlugin(
  vaultPath: string,
  pluginId: string
): Promise<void> {
  // Update community-plugins.json
}
```

**Status**: MISSING
**Complexity**: LOW

### 5. Just Recipes for E2E ❌
**File**: `justfile` (EXISTS but needs E2E recipes)

**Current recipes**:
- ✅ `just test` - Runs Jest unit tests
- ✅ `just setup` - Builds and installs plugin to test vault
- ❌ `just test:e2e` - MISSING
- ❌ `just test:e2e:headed` - MISSING
- ❌ `just test:e2e:debug` - MISSING

**Needed recipes**:
```makefile
# Run E2E tests headless
test:e2e:
    pnpm playwright test

# Run E2E tests with visible browser (useful for debugging)
test:e2e:headed:
    pnpm playwright test --headed

# Run E2E tests with Playwright inspector
test:e2e:debug:
    PWDEBUG=1 pnpm playwright test

# Full validation: unit + E2E
test:all:
    just test
    just test:e2e

# Setup E2E environment: build, install, seed vault
setup:e2e: build
    @echo "Setting up E2E environment..."
    @just setup
    @echo "✓ E2E environment ready"
```

**Status**: MISSING
**Complexity**: LOW

### 6. CI/CD Integration ❌
**File**: `.github/workflows/test.yml` (LIKELY MISSING, not checked)

**Needed**:
- Run E2E tests on PR
- Cache Playwright browsers
- Upload test artifacts (screenshots, traces) on failure
- Run on macOS runner (Obsidian only on desktop)

**Status**: UNKNOWN (not evaluated)
**Complexity**: MEDIUM

---

## Ambiguities Found

### Critical Ambiguities (Block E2E Implementation)

| Area | Question | Impact | Options |
|------|----------|--------|---------|
| **Obsidian Launch** | How to launch Obsidian with remote debugging? | Cannot automate Obsidian without this | 1) Wrap executable in shell script that adds `--remote-debugging-port`, 2) Use Obsidian's dev mode if available, 3) Launch separately and connect via CDP |
| **First-Time Setup** | How to handle "Trust this plugin?" prompt? | Tests will block on first run | 1) Pre-configure vault's `community-plugins.json` to trust plugin, 2) Automate clicking "Trust" button, 3) Research Obsidian config to disable prompt |
| **Plugin Enable** | How to ensure plugin is enabled on Obsidian launch? | Tests fail if plugin not loaded | 1) Pre-configure `community-plugins.json` with plugin ID, 2) Automate Settings → Plugins flow, 3) Use Obsidian CLI flags if available |
| **LLM Mocking** | Should E2E tests use real LLM API or mocks? | Real API = slow/flaky, mocks = not truly E2E | 1) Default to mocks (intercept HTTP), 2) Optional real API tests (separate suite), 3) Snapshot-based: record real responses, replay in tests |
| **Vault State** | Clean vault before each test or persist state? | Clean = slow but reliable, persist = fast but fragile | 1) Clean before each test (safest), 2) Clean before test suite (faster), 3) Use separate test vaults per test |

### Medium Ambiguities (Affect Test Quality)

| Area | Question | Impact | Options |
|------|----------|--------|---------|
| **Test Parallelization** | Can multiple Obsidian instances run in parallel? | Parallel = faster, serial = safer | 1) Serial only (workers: 1), 2) Research multi-instance support, 3) Use separate vaults per worker |
| **Error Screenshots** | Where to store failure screenshots? | Debugging failed tests | 1) `e2e/test-results/` (Playwright default), 2) CI artifacts, 3) `.gitignore` them |
| **Test Data** | Use seed-vault.sh data or custom per test? | Realistic vs. focused tests | 1) Seed vault as baseline, 2) Each test creates its own notes, 3) Hybrid: baseline + test-specific |
| **Obsidian Version** | Test against specific version or latest? | Stability vs. catching regressions | 1) Pin Obsidian version in CI, 2) Test against latest stable, 3) Matrix testing (multiple versions) |

---

## Dependencies and Risks

### External Dependencies

| Dependency | Status | Risk | Mitigation |
|------------|--------|------|------------|
| **Obsidian App** | ✅ Installed | HIGH - Closed-source, no API stability guarantees | Pin version in CI, monitor release notes |
| **Playwright** | ✅ Installed | LOW - Well-maintained | Keep updated, use stable APIs |
| **Electron CDP** | ⚠️ Experimental | MEDIUM - Playwright's Electron support is experimental | Have fallback to manual CDP connection |
| **Test Vault** | ✅ Script exists | LOW | Easy to regenerate |
| **LLM API** | ❌ Not configured for testing | MEDIUM - Tests may need real API | Mock by default, optional real API tests |

### Technical Risks

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| **Obsidian won't launch with debug flags** | HIGH | CRITICAL - Cannot automate | Research Obsidian forums, try shell script wrapper, contact Obsidian support |
| **UI selectors break on Obsidian updates** | HIGH | HIGH - Tests fail on version change | Use stable selectors (data-testid if possible), maintain selector library |
| **Plugin loading is non-deterministic** | MEDIUM | HIGH - Flaky tests | Add explicit waits for plugin ready state, poll for UI elements |
| **CDP connection hangs** | MEDIUM | HIGH - Tests timeout | Implement connection timeout, retry logic, kill stale processes |
| **File system race conditions** | MEDIUM | MEDIUM - Tests flaky | Add explicit file existence checks, wait for Obsidian indexing |
| **Obsidian settings not persisting** | LOW | MEDIUM - Settings tests fail | Verify `data.json` writes, add fsync waits |

### Project Risks

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| **E2E tests too slow** | HIGH | MEDIUM - Developers skip them | Optimize vault setup, cache Obsidian launch, run in CI only |
| **E2E tests too flaky** | HIGH | HIGH - Ignored failures | Invest in stability, use retries sparingly, monitor flake rate |
| **E2E tests block development** | MEDIUM | HIGH - Feature delivery slows | Make E2E optional for unit-tested code, gate only critical paths |
| **Maintenance burden** | MEDIUM | MEDIUM - Tests rot | Keep tests simple, document patterns, review regularly |

---

## Runtime Check Results

### Existing Checks
| Check Command | Purpose | Status |
|---------------|---------|--------|
| `pnpm run test` | Jest unit tests | ✅ PASS (all tests passing) |
| `pnpm run build` | TypeScript compilation + esbuild | ✅ PASS (builds successfully) |
| `pnpm run lint` | ESLint checks | ⚠️ NOT RUN (assume passing) |
| `pnpm run typecheck` | TypeScript type checking | ⚠️ NOT RUN (assume passing) |
| `just validate` | Lint + typecheck + test | ⚠️ NOT RUN (should pass) |

### Missing Checks (E2E)
1. **E2E Smoke Test** (`just test:e2e:smoke`)
   - Launch Obsidian with test vault
   - Verify plugin appears in sidebar
   - Click plugin icon
   - Verify chat view opens
   - Close Obsidian
   - Should run in <60 seconds
   - **Currently**: DOES NOT EXIST

2. **E2E Core Flow** (`just test:e2e:core`)
   - Open chat
   - Submit simple request: "Create note test.md"
   - Verify plan preview
   - Approve plan
   - Verify file created in vault
   - **Currently**: DOES NOT EXIST

3. **E2E Full Suite** (`just test:e2e`)
   - All E2E test scenarios
   - ~5-10 minutes runtime target
   - **Currently**: DOES NOT EXIST

---

## Data Flow Verification

**E2E-specific flows to test** (cannot be unit tested):

| Flow | Input | Process | Store | Retrieve | Display |
|------|-------|---------|-------|----------|---------|
| **User submits request** | Text input | → LLM API | → Plan JSON | → Plan preview | ✅ Need E2E |
| **User approves plan** | Click approve | → Executor | → Vault write | → File created | ✅ Need E2E |
| **Plugin settings saved** | Settings UI | → Plugin data | → data.json | → Next load | ✅ Need E2E |
| **Error displayed to user** | Failed step | → Executor error | → UI update | → Error message | ✅ Need E2E |
| **Macro saved** | Save plan | → MacroStore | → vault file | → Macro list | ✅ Need E2E |

**None of these flows are currently E2E tested.**

---

## Recommendations

### Priority 1: Critical Path (Unblocks E2E Testing)

1. **Resolve Obsidian Launch Ambiguity** ⭐ CRITICAL
   - Research how to launch Obsidian with `--remote-debugging-port`
   - Test CDP connection manually
   - Document working approach
   - **Effort**: 4-8 hours research + experimentation
   - **Blocker**: Cannot proceed without this

2. **Create Playwright Config** ⭐ HIGH
   - Create `playwright.config.ts`
   - Configure test directory, timeouts, workers
   - Set up trace/screenshot on failure
   - **Effort**: 1 hour
   - **Dependencies**: None

3. **Build Obsidian Launcher Helper** ⭐ HIGH
   - Create `e2e/helpers/obsidian-launcher.ts`
   - Implement `launchObsidian()` with CDP connection
   - Implement `closeObsidian()` with cleanup
   - Test manually
   - **Effort**: 2-4 hours
   - **Dependencies**: Resolution of #1

4. **Write First E2E Test** ⭐ HIGH
   - Create `e2e/smoke.spec.ts`
   - Test: Launch Obsidian → Verify plugin loaded → Close
   - Verify test can run and pass
   - **Effort**: 2-3 hours
   - **Dependencies**: #2, #3

### Priority 2: Core Coverage (Essential E2E Scenarios)

5. **Implement Plugin Lifecycle Tests**
   - `e2e/plugin-lifecycle.spec.ts`
   - Load plugin, verify sidebar icon, open chat view
   - **Effort**: 3-4 hours

6. **Implement Chat Interface Tests**
   - `e2e/chat-interface.spec.ts`
   - Type message, submit, verify message history
   - **Effort**: 2-3 hours

7. **Implement Plan Approval Tests**
   - `e2e/plan-approval.spec.ts`
   - Submit request, review plan, approve, verify execution
   - **Effort**: 4-6 hours (includes LLM mocking strategy)

8. **Implement Execution Verification Tests**
   - `e2e/execution-verification.spec.ts`
   - Submit plan, verify vault file created/modified
   - **Effort**: 3-4 hours

### Priority 3: Infrastructure (Developer Experience)

9. **Create Vault Helper Utilities**
   - `e2e/helpers/vault-helpers.ts`
   - Clean vault, verify files, read files
   - **Effort**: 1-2 hours

10. **Create Plugin Helper Utilities**
    - `e2e/helpers/plugin-helpers.ts`
    - Install plugin, enable plugin, configure settings
    - **Effort**: 2-3 hours

11. **Add Just Recipes**
    - `just test:e2e`, `test:e2e:headed`, `test:e2e:debug`
    - `just setup:e2e` (combined build + install + seed)
    - **Effort**: 30 minutes

12. **Resolve First-Time Setup Ambiguity**
    - Auto-configure `community-plugins.json` to trust plugin
    - Or automate "Trust" button click
    - Document in `e2e/README.md`
    - **Effort**: 2-3 hours

### Priority 4: Stability & CI (Production Ready)

13. **Implement LLM Mocking Strategy**
    - Intercept HTTP requests to LLM API
    - Return pre-recorded responses
    - Document how to record new snapshots
    - **Effort**: 3-4 hours

14. **Add Error Handling Tests**
    - Failed execution, network errors, timeout errors
    - Verify user sees friendly error messages
    - **Effort**: 2-3 hours

15. **Set Up CI/CD Integration**
    - `.github/workflows/e2e.yml`
    - Run on macOS runner
    - Cache Playwright browsers
    - Upload artifacts on failure
    - **Effort**: 2-3 hours

16. **Optimize Test Performance**
    - Measure test suite runtime
    - Optimize vault setup (cache?)
    - Optimize Obsidian launch (keep alive between tests?)
    - Target <5 minutes for full suite
    - **Effort**: 2-4 hours

---

## Estimated Effort Summary

| Phase | Tasks | Estimated Effort | Complexity |
|-------|-------|-----------------|------------|
| **Priority 1: Critical Path** | 4 tasks | 10-16 hours | HIGH (research heavy) |
| **Priority 2: Core Coverage** | 4 tasks | 12-17 hours | MEDIUM-HIGH |
| **Priority 3: Infrastructure** | 4 tasks | 6-9 hours | MEDIUM |
| **Priority 4: Stability & CI** | 4 tasks | 9-14 hours | MEDIUM |
| **TOTAL** | 16 tasks | **37-56 hours** | MEDIUM-HIGH |

**Realistic Timeline**:
- **Minimum Viable E2E**: Priority 1 only = 1-2 days (10-16 hours)
- **Core E2E Coverage**: Priority 1-2 = 3-5 days (22-33 hours)
- **Production Ready**: Priority 1-4 = 1-2 weeks (37-56 hours)

---

## Workflow Recommendation

✅ **CONTINUE** - Issues are clear, implementer can proceed

**Next Actions**:
1. Research Obsidian launch with remote debugging (CRITICAL BLOCKER)
2. Create `playwright.config.ts`
3. Build `obsidian-launcher.ts` helper
4. Write first smoke test
5. Iterate on coverage

**Clarification NOT Needed**: Path forward is clear once Obsidian launch ambiguity is resolved through research/experimentation.

---

## Sources Referenced

- [Playwright Electron API](https://playwright.dev/docs/api/class-electron)
- [ElectronApplication | Playwright](https://playwright.dev/docs/api/class-electronapplication)
- [Automated Testing | Electron](https://www.electronjs.org/docs/latest/tutorial/automated-testing)
- [Unit Testing Your Plugins (AKA Automating Obsidian) - Obsidian Forum](https://forum.obsidian.md/t/unit-testing-your-plugins-aka-automating-obsidian/54416)
- [GitHub - pedersen/obsidian-testing-vault](https://github.com/pedersen/obsidian-testing-vault)
- [GitHub - kaelri/obsidian-test-vault](https://github.com/kaelri/obsidian-test-vault)

---

## Appendix: Test File Structure (Proposed)

```
obsidian-toolagent/
├── e2e/
│   ├── helpers/
│   │   ├── obsidian-launcher.ts    # Launch/close Obsidian with CDP
│   │   ├── vault-helpers.ts         # Clean vault, verify files
│   │   ├── plugin-helpers.ts        # Install/enable plugin
│   │   └── llm-mocks.ts             # Mock LLM responses
│   ├── fixtures/
│   │   ├── plans/                   # Sample plan JSONs
│   │   └── responses/               # LLM response snapshots
│   ├── smoke.spec.ts                # Minimal: plugin loads
│   ├── plugin-lifecycle.spec.ts     # Load, enable, disable
│   ├── chat-interface.spec.ts       # UI interactions
│   ├── plan-approval.spec.ts        # Preview, approve, cancel
│   ├── execution-verification.spec.ts # Vault changes
│   ├── settings.spec.ts             # Settings persistence
│   ├── error-handling.spec.ts       # Error scenarios
│   └── macros.spec.ts               # Save/replay macros
├── playwright.config.ts             # Playwright configuration
└── justfile                         # Updated with E2E recipes
```

---

**End of Evaluation**
